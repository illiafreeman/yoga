!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("global/document"),require("global/window")):"function"==typeof define&&define.amd?define(["global/document","global/window"],t):(e=e||self).brightcovePlayerLoader=t(e.document,e.window)}(this,function(u,l){"use strict";function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}u=u&&u.hasOwnProperty("default")?u.default:u,l=l&&l.hasOwnProperty("default")?l.default:l;function a(e){var t=e.accountId,n=void 0===(a=e.base)?"https://players.brightcove.net":a,r=void 0===(i=e.playerId)?"default":i,o=void 0===(d=e.embedId)?"default":d,i=void 0!==(a=e.iframe)&&a,a=void 0===(d=e.minified)||d,e=void 0===(d=e.queryParams)?null:d,d="";i?d+="html":(a&&(d+="min."),d+="js"),"/"===n.charAt(n.length-1)&&(n=n.substring(0,n.length-1));var l,a="";return i&&e&&"object"===(void 0===e?"undefined":c(e))&&(l=e,a=Object.keys(l).filter(function(e){return-1!==p.indexOf(e)}).reduce(function(e,t){var n=function(e,t){if(e&&void 0!==e[t]){if("string"!=typeof e[t]&&-1!==s.indexOf(t))try{return encodeURIComponent(JSON.stringify(e[t]))}catch(e){return}return encodeURIComponent(String(e[t]).trim())||void 0}}(l,t);return void 0!==n&&(e+=e?"&":"?",e+=encodeURIComponent(t)+"="+n),e},"")),n+"/"+encodeURIComponent(t)+"/"+encodeURIComponent(r)+"_"+encodeURIComponent(o)+"/index."+d+a}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=["catalogSearch","catalogSequence"],p=["adConfigId","applicationId","catalogSearch","catalogSequence","playlistId","playlistVideoId","videoId"];a.VERSION="1.2.0";function m(e){if(e.playerUrl)return e.playerUrl;var t=e.accountId,n=e.playerId,r=e.embedId,o=e.embedOptions,i=e.embedType===O;return a({accountId:t,playerId:n,embedId:r,iframe:i,base:d,minified:!o||!o.unminified,queryParams:e})}function y(e){return Boolean(e&&1===e.nodeType)}function b(e){return Boolean(y(e)&&e.parentNode)}function E(e){return n=function(e,t){if("function"!=typeof e.onEmbedCreated)return t;e=e.onEmbedCreated(t);return y(e)?e:t}(t=e,e.embedType===O?(c=e,(s=u.createElement("iframe")).setAttribute("allow","autoplay;encrypted-media;fullscreen"),s.setAttribute("allowfullscreen","allowfullscreen"),s.src=m(c),s):(a=(i=e).embedOptions,d={adConfigId:"data-ad-config-id",applicationId:"data-application-id",catalogSearch:"data-catalog-search",catalogSequence:"data-catalog-sequence",deliveryConfigId:"data-delivery-config-id",playlistId:"data-playlist-id",playlistVideoId:"data-playlist-video-id",poster:"poster",videoId:"data-video-id"},a=a&&a.tagName||I,l=u.createElement(a),Object.keys(d).filter(function(e){return i[e]}).forEach(function(e){var t;if("string"!=typeof i[e]&&-1!==A.indexOf(e))try{t=JSON.stringify(i[e])}catch(e){return}else t=String(i[e]).trim();l.setAttribute(d[e],t)}),l.setAttribute("controls","controls"),l.classList.add("video-js"),l)),r=t.refNode,o=t.refNodeInsert,c=r.parentNode,s=t.embedType,e=t.embedOptions,a=n,a=e?function(e,t){if(!e.pip)return t;e=u.createElement("div");return e.classList.add("vjs-pip-container"),e.appendChild(t),e}(e,function(e,t,n){if(!t.responsive)return n;n.style.position="absolute",n.style.top="0px",n.style.right="0px",n.style.bottom="0px",n.style.left="0px",n.style.width="100%";var r=f({aspectRatio:"16:9",iframeHorizontalPlaylist:!(n.style.height="100%"),maxWidth:"100%"},t.responsive),o=r.aspectRatio.split(":").map(Number),t=u.createElement("div"),o=o[1]/o[0]*100;e===O&&r.iframeHorizontalPlaylist&&(o*=1.25),t.style.paddingTop=o+"%",t.appendChild(n);n=u.createElement("div");return n.style.position="relative",n.style.display="block",n.style.maxWidth=r.maxWidth,n.appendChild(t),n}(s,e,a)):a,o===R?c.insertBefore(a,r):o===S?c.insertBefore(a,r.nextElementSibling||null):o===P?c.replaceChild(a,r):o===_?r.insertBefore(a,r.firstChild||null):r.appendChild(a),t.embedOptions&&t.embedOptions.playlist&&(a=t.embedOptions.playlist.legacy?"ul":"div",(a=u.createElement(a)).classList.add("vjs-playlist"),n.parentNode.insertBefore(a,n.nextElementSibling||null)),t.refNode=null,n;var t,n,r,o,i,a,d,l,c,s}function t(e){return(e.accountId||"*")+"_"+e.playerId+"_"+e.embedId}function v(e){return i.has(t(e))}function h(e){i.set(t(e),e.accountId?m(e):"")}function e(){return l.bc?Object.keys(l.bc).filter(function(e){return C.test(e)}):[]}function n(t){t&&Object.keys(t.players).forEach(function(e){e=t.players[e];e&&e.dispose()})}function r(){i.forEach(function(e,t){e&&Array.prototype.slice.call(u.querySelectorAll('script[src="'+e+'"]')).forEach(function(e){return e.parentNode.removeChild(e)})}),i.clear(),n(l.videojs),e().forEach(function(e){return n(l.bc[e].videojs)}),Object.keys(l).filter(function(e){return/^videojs/i.test(e)||/^(bc)$/.test(e)}).forEach(function(e){delete l[e]})}var o={embedId:"default",embedType:"in-page",playerId:"default",Promise:l.Promise,refNodeInsert:"append"},g="video",I="video-js",N="in-page",O="iframe",w="append",_="prepend",R="before",S="after",P="replace",A=["catalogSearch","catalogSequence"],d="https://players.brightcove.net/",i=new l.Map,C=/^([A-Za-z0-9]+)_([A-Za-z0-9]+)$/;e().forEach(function(e){e=e.match(C),e={playerId:e[1],embedId:e[2]};v(e)||h(e)});function j(e){return"function"==typeof e}function T(t,e,n,r){var o,i=t.embedId,a=t.playerId,d=l.bc[a+"_"+i]||l.bc;if(!d)return r(new Error("missing bc function for "+a));h(t);try{(o=d(e,t.options)).bcinfo&&(o.bcinfo.PLAYER_LOADER=!0)}catch(e){a="Could not initialize the Brightcove Player.";return t.embedOptions.tagName===I&&(a+=' You are attempting to embed using a "video-js" element. Please ensure that your Player is v6.11.0 or newer in order to support this embed type. Alternatively, pass `"video"` for `embedOptions.tagName`.'),r(new Error(a))}n({type:N,ref:o})}function x(e,t,n){e.refNode=(d=e.refNode,b(d)?d:"string"==typeof d?u.querySelector(d):null),function(e){var t,n=e.accountId,r=e.embedOptions,o=e.embedType,i=e.options,a=e.refNode,e=e.refNodeInsert;if(!n)throw new Error("accountId is required");if(!b(a))throw new Error("refNode must resolve to a node attached to the DOM");if(o!==N&&o!==O)throw new Error("embedType is missing or invalid");if(o===O&&i)throw new Error("cannot use options with an iframe embed");if(r&&void 0!==r.tagName&&(t=r.tagName)!==I&&t!==g)throw new Error('embedOptions.tagName is invalid (value: "'+r.tagName+'")');if(r&&r.responsive&&r.responsive.aspectRatio&&!/^\d+\:\d+$/.test(r.responsive.aspectRatio))throw new Error('embedOptions.responsive.aspectRatio must be in the "n:n" format (value: "'+r.responsive.aspectRatio+'")');if(e!==w&&e!==_&&e!==R&&e!==S&&e!==P)throw new Error("refNodeInsert is missing or invalid")}(e);var r=e.refNode,o=e.refNodeInsert,i=r.parentNode,a=E(e);if(e.embedType!==O){if(v(e))return T(e,a,t,n);var d=u.createElement("script");d.onload=function(){return T(e,a,t,n)},d.onerror=function(){n(new Error("player script could not be downloaded"))},d.async=!0,d.charset="utf-8",d.src=m(e),(o===P?i:r).appendChild(d)}else t({type:O,ref:a})}function D(e){var n=f({},o,e),t=n.Promise,r=n.onSuccess,e=n.onFailure;return!j(t)||j(r)||j(e)?x(n,j(r)?r:function(){},j(e)?e:function(e){throw e}):new t(function(e,t){return x(n,e,t)})}function B(e,t){Object.defineProperty(D,e,{configurable:!1,enumerable:!0,value:t,writable:!1})}return B("getBaseUrl",function(){return d}),B("setBaseUrl",function(e){d=e}),B("getUrl",m),B("reset",r),[["EMBED_TAG_NAME_VIDEO",g],["EMBED_TAG_NAME_VIDEOJS",I],["EMBED_TYPE_IN_PAGE",N],["EMBED_TYPE_IFRAME",O],["REF_NODE_INSERT_APPEND",w],["REF_NODE_INSERT_PREPEND",_],["REF_NODE_INSERT_BEFORE",R],["REF_NODE_INSERT_AFTER",S],["REF_NODE_INSERT_REPLACE",P],["VERSION","1.8.0"]].forEach(function(e){B(e[0],e[1])}),D});
//# sourceMappingURL=brightcove-player-loader.js.map
